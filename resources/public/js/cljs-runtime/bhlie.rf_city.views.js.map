{"version":3,"sources":["bhlie/rf_city/views.cljs"],"mappings":"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","names":["bhlie.rf-city.views/get-city-info","fork.re-frame/form","e","re-frame.core/dispatch","p__32831","map__32832","cljs.core/--destructure-map","cljs.core.get","values","form-id","handle-change","handle-blur","submitting?","handle-submit","bhlie.rf-city.views/gmap-inner","map__32833","lat","lon","reagent.core/props","reagent.core/current-component","reagent.core.create_class","_","canvas","goog.dom/getElement","js/parseFloat","bhlie.rf-city.views/gmap-outer","cljs.core/deref","pos","re_frame.core.subscribe","bhlie.rf-city.views/map-tile","bhlie.rf-city.views/city-tile","map__32834","display_name","err","js/Error","or__5045__auto__","bhlie.rf-city.views/movies-tile","movies","cljs.core.into","iter__5523__auto__","s__32836","cljs.core/LazySeq","temp__5804__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__5521__auto__","size__5522__auto__","cljs.core/count","b__32838","cljs.core/chunk-buffer","i__32837","map__32839","cljs.core/-nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__32835","cljs.core/chunk-rest","map__32840","cljs.core/first","cljs.core/cons","cljs.core/rest","title","release_date","popularity","bhlie.rf-city.views/weather-tile","weather","s__32842","b__32844","i__32843","map__32845","iter__32841","map__32846","min_temp","max_temp","datetime","desc","bhlie.rf-city.views/current-location","bhlie.rf-city.views/home","bhlie.rf-city.views/city-router","reitit.frontend.router","cljs.core/chunk-first"],"sourcesContent":["(ns bhlie.rf-city.views\n  (:require [bhlie.rf-city.subs]\n            [re-frame.core :as re-frame :refer [subscribe dispatch]]\n            [reagent.core :as r]\n            [fork.re-frame :as fork]\n            [goog.object :as gobj]\n            [goog.dom :as gdom]\n            [reitit.frontend :refer [router]]))\n\n(defn get-city-info []\n  [:div {:id :user-info-entry}\n   [fork/form {:form-id \"map-lookup\"\n               :path [:map-lookup]\n               :prevent-default? true\n               :clean-on-unmount? true\n               :on-submit (fn [e] (dispatch [:app/handle-form-submission e])\n                            (dispatch [:events/push-state :maps]))}\n    (fn [{:keys [values form-id handle-change handle-blur submitting?\n                 handle-submit]}]\n      [:form {:name :travel-info\n              :id form-id\n              :on-submit handle-submit}\n       [:input {:id :destination\n                :required true\n                :name \"destination\"\n                :value (values \"destination\")\n                :type \"textarea\"\n                :on-change handle-change\n                :on-blur handle-blur\n                :placeholder \"Destination\"}]\n       [:label \"From: \"\n        [:input {:id :date-from\n                 :type \"date\"\n                 :min \"2023-04-11\"}]]\n       [:label \"To: \"\n        [:input {:id :date-to\n                 :type \"date\"}]]\n       [:button {:id :submit-search\n                 :type :submit\n                 :disabled submitting?} \"Get trip info\"]])]])\n\n(defn gmap-inner []\n  (let [{:keys [lat lon]} (r/props (r/current-component))]\n    (r/create-class {:reagent-render (fn [] [:div\n                                            [:div#map-canvas {:style {:height \"400px\"}}]])\n                    :component-did-mount (fn [_] (let [canvas (gdom/getElement \"map-canvas\")]\n                                                   (dispatch [:config/load-google-maps {:canvas canvas\n                                                                                        :lat (js/parseFloat lat)\n                                                                                        :lon (js/parseFloat lon)\n                                                                                        :zoom 13}])))})))\n\n(defn gmap-outer []\n  (let [pos @(subscribe [:geo/live-map-coords])] \n    (fn [] [gmap-inner pos])))\n\n(defn map-tile []\n  [:div {:id :map-container}\n   [:img {:src @(subscribe [:geo/static-map])\n          :id :static-map}]\n   [gmap-outer]])\n\n(defn city-tile []\n  (let [{:keys [display_name lat lon]} @(subscribe [:geo/city-top-match])\n        err @(subscribe [:geo/map-error])]\n    (cond (some? err)\n          (throw (js/Error. \"API is busted\"))\n          (some? (or lat lon))\n          [:div {:id :city-info}\n           [:h1 display_name]\n           [map-tile]\n           [:h4 \"Latitude: \" lat]\n           [:h4 \"Longitude: \" lon]])))\n\n(defn movies-tile []\n  (let [movies @(subscribe [:movies/sorted])]\n    [:div {:id :movies}\n     [:h2 \"Movies about this city\"]\n     [:label {:for \"sort-by\"} \"Sort by: \"]\n     [:select {:name \"sort-by\"\n               :id :select-filter\n               :on-change (fn [e] (dispatch [:movies/sort-key (.. e -target -value)]))}\n      [:option {:value \"popularity\"} \"Popularity\"]\n      [:option {:value \"title\"} \"Title\"]\n      [:option {:value \"release_date\"} \"Release date\"]]\n     (into [:div {:id :movies-list}]\n           (for [{:keys [title release_date popularity]} movies]\n             [:div {:id :movie-each} [:h4 title]\n              [:h6 \"Release date: \" release_date]\n              [:p \"Rating: \" popularity]]))]))\n\n(defn weather-tile []\n  (let [weather @(subscribe [:geo/weather-data])]\n    [:div {:id :seven-day-forecast}\n     [:h2 \"Seven-day weather forecast\"]\n     (for [{:keys [min_temp max_temp weather datetime]} (:data weather)\n           :let [desc (:description weather)]]\n       [:div {:id :daily-forecast}\n        [:p {:id :date} datetime]\n        [:p \"Low: \" min_temp (str \"\\u00B0\" \"C\")]\n        [:p \"High \" max_temp (str \"\\u00B0\" \"C\")]\n        [:p desc]])]))\n\n(defn current-location []\n  [:div {:id :user-loc}\n   [:p#current-loc (str \"Your current location is: \" @(subscribe [:app/current-location]))]])\n\n(defn home []\n  [:div {:id :home-page}\n   [:div {:id :welcome-msg}\n    [:img {:src \"/icons8-globe-30.png\" :id :globe}]\n    [:p \"Welcome to City Explorer!\"] \n    [:p \"Here you can explore things to do in your favorite cities around the globe! Plan a trip in the search tab, or view maps, movies, or weather data.\"]]])\n\n(def city-router (router [\"/\"\n                          [\"\" {:name :home\n                               :view home\n                               :link-text \"Home\"\n                               :controllers [{:start (fn [& _] (dispatch [:app/highlight-active-link]))}]}]\n                          [\"search\" {:name :search\n                                     :view get-city-info\n                                     :link-text \"Search\"\n                                     :controllers [{:start (fn [& _] (dispatch [:app/highlight-active-link]))}]}]\n                          [\"maps\" {:name :maps\n                                   :view city-tile\n                                   :link-text \"Maps\"\n                                   :controllers [{:start (fn [& _] ())}]}]\n                          [\"movies\" {:name :movies\n                                     :view movies-tile\n                                     :link-text \"Movies\"\n                                     :controllers [{:start (fn [& _] (dispatch [:app/highlight-active-link]))}]}]\n                          [\"weather\" {:name :weather\n                                      :view weather-tile\n                                      :link-text \"Weather\"\n                                      :controllers [{:start (fn [& _] (dispatch [:app/highlight-active-link]))}]}]]))"]}